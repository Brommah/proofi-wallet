# 2025-02-02

## ðŸ”‘ CORE INSIGHT: Cere + CEF = Ã‰Ã©n Machine

**Dit is het fundament. Vergeet dit nooit.**

Cere = protocol (storage, verification, settlement). CEF = product (developer experience, serverless runtime).

Geen van beide werkt alleen:
- Cere zonder CEF = infra die niemand direct gebruikt
- CEF zonder Cere = generiek serverless platform zonder moat

**Samen = Ã©Ã©n vliegwiel:**
- CEF wint developers met DX (Lambda voor agents)
- Cere geeft CEF wat geen concurrent kan kopiÃ«ren (trustless verification, native settlement, sovereign storage)
- Developer kiest CEF omdat het makkelijk is
- Enterprise kiest CEF omdat het bewezen veilig is
- Adoptie â†’ activity op Cere â†’ netwerk waardevoller â†’ CEF aantrekkelijker

**De verification is een feature, niet de pitch.** De pitch is: "deploy agents die shit doen, en als iemand vraagt of het klopt, heb je het bewijs." Verification moet onzichtbaar zijn, zoals HTTPS/TLS â€” het is er, maar je hoeft er niet over na te denken. CEF abstraheert DDC, DAC, keys, encryption â€” allemaal under the hood.

**Concept rating: 9/10. Executie: 4/10. De -1 is puur "ship het."**

---

## Blockchain Deep Dive Results (Live Queries)

### Bucket 1229 (on-chain confirmed):
- **Owner:** `6QtsJ6EFAassYbt8uSq4fyqCL83tEuqYyDHvqv4pkkLey2Q4` (Mart's wallet)
- **Cluster ID:** `0x0059f5ada35eee46802d80750d5ca4a490640511` (Dragon1)
- **Public:** true
- **Cluster status:** Activated, managed by `6VBDWvZHgzTJTrCkwXVHMoSZ45c6TweunwjftzFS77x9TiXe`
- **Erasure coding:** required=16, total=48, replication=20
- **60+ storage nodes** in cluster, all ValidationSucceeded

### Storage Node Details (from chain):
- Nodes have: host IP, domain (storage-XX.ddc-dragon.com), SSL, HTTP 8080, gRPC 9090, P2P 9070
- Example: storage-35 = 178.18.148.216, storage-63 = 178.251.228.23

### ðŸ† BREAKTHROUGH: Full DAC Receipt Retrieved!
- **Era 29406534** (Nov 29, 2025 04:54 UTC)
- Activity Record ID: `582f8ac8eff6432092159cf60b6f9cb4`
- Request: GET of `baear4ifclxl3s7airdtopr6ff34vohfg6i3ll47lr6cqtcopepvkcmlzs4/Screenshot 2025-04-07 at 16.01.01.png`
- Bucket 1229, 4.2MB delivered, ED25519 signed by node `0x1451498b...`
- Full Merkle proof decoded from protobuf ChallengeResponse
- **This proves the entire DAC pipeline works** â€” capture, aggregation, Merkle proofs, signed receipts

### Key Discovery: How to Query DAC
1. Find bucket â†’ cluster mapping on-chain: `DdcCustomers.Buckets[bucketId]`
2. Find cluster nodes: `DdcClusters.ClustersNodes` â†’ map to `DdcNodes.StorageNodes[pubkey]` for IPs
3. Find grouping collector: `GET /activity/is-grouping-collector` on each node
4. List eras: `GET /activity/eras` â†’ find eras with `records_processed > 0`
5. Get bucket aggregates: `GET /activity/buckets?eraId={eraId}`
6. Get Merkle proof: `GET /activity/buckets/{bucketId}/challenge?eraId={eraId}&nodeId={nodeId}&merkleTreeNodeId=1` (Accept: application/protobuf)
7. Decode with activity.proto from `Cerebellum-Network/ddc-api` repo

### Proto files location
- `Cerebellum-Network/ddc-api/src/protos/activity.proto` â€” ActivityRecord, ChallengeResponse, Merkle proofs
- `Cerebellum-Network/ddc-api/src/protos/inspection.proto` â€” ITM tables, inspection receipts
- Full HTTP API in `src/client.rs` â€” all endpoints documented

### DAC IS RUNNING (correction of earlier assessment)
- TCA aggregation active: IDs incrementing (29499805+), 60-second eras
- 115,350+ eras processed on storage-59
- 4,485 eras with actual activity records on g-collector storage-1
- G-collector for Dragon1: storage-1.ddc-dragon.com
- DAC logs confirm active polling of peer nodes via gRPC on port 9070

### ROB Developer Console (LIVE!)
- Dev: https://rob.dev.cere.io/#/login
- Staging: https://rob.stage.cere.io/
- Prod: https://rob.cere.io/#/login
- Auth: JWT via Cere Wallet
- API: Agent Services, Workspaces, Engagements, Deployments
- Agent Runtime: `compute.devnet.ddc-dragon.com/agent/health` â†’ healthy
- Frontend repo: cere-io/dynamic-indexer-client
- Backend repo: cere-io/rob-api

### CEF Agent Runtime â€” How Agents Work
- Agents are TypeScript functions: `async function handle(event, context) { ... }`
- V8 isolate per execution (secure sandbox)
- Context API provides: `context.log()`, `context.models.infer()`, `context.agents.call()`, `context.storage.save()`, `context.streams.subscribe()`, `context.fetch()`
- Every operation metered: CPU, memory, model calls, storage writes
- Agents CANNOT: arbitrary HTTP, filesystem, native modules, sockets
- Agents CAN: ML inference, inter-agent calls, DDC storage, stream processing
- Two types: Ephemeral (event handlers) and Streaming (long-lived)
- Deploy via ROB console â†’ Ansible â†’ K3s/Helm â†’ V8 Runtime

### Critical Finding: DAC Billing Stopped at June 2024
- Last finalized on-chain billing era: **19903** (June 30, 2024)
- 58 total billing reports on-chain for Dragon1
- Activity API on storage nodes returns **empty** for all recent eras
- Means: activity data may still be captured locally but NOT aggregated/settled on-chain since July 2024
- This is a **major gap** â€” the on-chain verification chain is broken for recent data

### Pallets Found:
- DdcCustomers, DdcClusters, DdcNodes, DdcPayouts, DdcVerification
- Storage node details queryable via DdcNodes.StorageNodes[pubkey]

## Cere DDC Activity Tracking Research
Mart mapped out all access points for querying DDC activity/usage data:

### Working methods:
1. **Storage Node HTTP API** (direct to nodes) - bucket aggregates, node traversal, EHD traversal
2. **Developer Console Billing Dashboard** (dev/staging) - customer billing reports, era details
3. **Grafana Dashboards** - dashboards.cere.io (Dragon1), dashboard.cere.network (blockchain)
4. **Blockchain verification** - on-chain Charged events matched via verification scripts

### Key gap identified:
- No public-facing API to query individual activity records by CID or timestamp
- Flow: Activity Records â†’ TCA aggregation (per minute) â†’ EHD (per era) â†’ On-chain
- To trace a specific store action need: collector node for that bucket â†’ gRPC for TCA â†’ match CID

### Key people:
- **Yahor/Alisher** - built DAC internals, have direct access
- **DAC Indexer RFP** - open grant proposal to build columnar database for querying activity data

### References found in Slack/Notion:
- Slack C07ANDHGSHY - Storage node API examples
- Notion: DAC Receipts Wiki, DAC Inspection Wiki
- Slack C0686LZ2A - DAC Indexer RFP discussion

## ROB Deep Dive â€” Hands-On Audit Results

### Logged into ROB Prod + Devnet
- Prod: rob.cere.io (logged in as martijn@cere.io)
- Devnet: rob.dev.cere.io (logged in, different UI than prod)
- Prod has: Data Services, Agent Registry, Model Registry
- Devnet has: Agent Services only (different naming, different UI)

### Critical Bugs Found
1. **Agent Creation 400** â€” Frontend doesn't send `metadata: {}` on task objects â†’ `tasks.0.metadata must be an object`
2. **Prod MySQL Read-Only** â€” All writes blocked: `MySQL server is running with --read-only option`
3. **Devnet Service Creation Silent Fail** â€” Click create â†’ nothing happens
4. **Model Mismatch** â€” Registry shows 7 models, agent wizard shows 5 different LLM models
5. **Error messages hidden** â€” UI shows generic "status code 400" instead of actual API error

### What Works
- 3 existing agents: Simple Test, Sum agent, Test (all Programmable)
- "Bullish" Data Service: 4 Rafts, 1 Data Source, Active
- Model Registry: 7 featured models, 2.5M invocations
- Agent Runtime: compute.devnet.ddc-dragon.com â†’ healthy
- API reads work (GET /agent-registry, GET /model-registry, GET /data-services)

### LLM Models Available (from agent create dropdown, not in Model Registry):
- Qwen2.5-1.5B-Instruct (lightweight, MCP support)
- Microsoft Phi-3 Mini (3.8B)
- Hermes-2-Pro-LLaMA-3-8B
- Mistral-7B-Instruct-v0.3
- Llama-3.1-8B-Instruct

### API Surface
- Base: `https://api.rob.cere.io/rms-node-backend/`
- Auth: JWT Bearer token via Cere Wallet (ed25519 signed)
- POST /agent-registry â€” creates agent (currently broken)
- GET /agent-registry â€” lists agents (works)

### Deliverables Created
- `docs/ROB-UX-STRATEGY-v3.md` â€” Comprehensive UI/UX improvement strategy
- `rob-mission-control/index.html` â€” Interactive Mission Control Center dashboard
- Sub-agents running: full page-by-page audit of prod + devnet
