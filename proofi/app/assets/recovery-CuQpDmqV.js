import{c as s,K as y}from"./index-CIXpEU_L.js";async function p(r,e){const t=new TextEncoder,n=await crypto.subtle.importKey("raw",t.encode(r),"PBKDF2",!1,["deriveBits"]),o=await crypto.subtle.deriveBits({name:"PBKDF2",hash:"SHA-256",salt:t.encode(e),iterations:1e5},n,256),i=new Uint8Array(o);return"0x"+Array.from(i).map(a=>a.toString(16).padStart(2,"0")).join("")}async function l(r){await s();const e=new y;return e.ss58Prefix=54,await e.init(),e.importKey({type:"sr25519",secretKey:r,label:"proofi-wallet",purposes:["transaction","credential","authentication"]})}async function m(r,e){const t=new TextEncoder,n=crypto.getRandomValues(new Uint8Array(12)),o=await crypto.subtle.importKey("raw",t.encode(e),"PBKDF2",!1,["deriveKey"]),i=await crypto.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:t.encode("proofi-encrypt"),iterations:5e4},o,{name:"AES-GCM",length:256},!1,["encrypt"]),a=await crypto.subtle.encrypt({name:"AES-GCM",iv:n},i,t.encode(r)),c=new Uint8Array(n.length+a.byteLength);return c.set(n),c.set(new Uint8Array(a),n.length),btoa(String.fromCharCode(...c))}export{l as deriveKeypairFromSeed,p as deriveSeedFromPin,m as encryptSeed};
